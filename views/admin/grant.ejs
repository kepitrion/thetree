<style>
    @scope (#content-style) {
        form input, form select {
            background-color: rgb(255, 255, 255);
            background-image: none;
            border: 0.0625rem solid rgb(204, 204, 204);
            border-radius: 0;
            color: rgb(85, 89, 92);
            display: inline-block;
            font-size: 0.9rem;
            line-height: 1.5;
            margin: 0 0 0 0.7rem;
            padding: 0.25rem 0.5rem;
        }
    }

    .button-block {
        column-gap: .25rem;
        display: flex;
        justify-content: flex-end;
        margin-top: 2rem;
    }
</style>

<%const targetUserExists = typeof targetUser !== undefined && !!targetUser;%>

<form id="grant-form">
    <p>
        Username
        <input name="username" value="<%=req.query.username%>" required<%=targetUserExists ? '' : ' autofocus'%>>
    </p>

    <div class="button-block">
        <button class="thetree-square-button thetree-blue-button">확인</button>
    </div>
</form>

<%if(targetUserExists) {%>
<form method="post">
    <input type="hidden" name="uuid" value="<%=targetUser.uuid%>">
    <h3><%=targetUser.name%></h3>

    <%for(let perm of grantablePermissions) {%>
        <p>
            <label for="perm_<%=perm%>"><%=perm%></label>
            <input type="checkbox" id="perm_<%=perm%>" name="<%=perm%>" value="Y"<%=targetUser.permissions.includes(perm) ? ' checked' : ''%>>
        </p>
    <%}%>

    <div class="button-block">
        <%if(req.permissions.includes('developer')) {%>
            <label>
                hidelog:
                <input type="checkbox" name="hidelog" value="Y">
            </label>
        <%}%>
        <button class="thetree-square-button thetree-blue-button">확인</button>
    </div>
</form>
<%}%>